Semestrální práce na téma hry Pac-Man                        {#mainpage}
============

## Školní zadání z Progtestu


Implementujte klasickou hru Pacman proti počítači (můžete naimplementovat i jiné varianty).

Hra musí splňovat následující funkcionality:

1.    Dodržování základních pravidel, sbírání bonusů, míncí (teček), třešniček, teleporty, atp.
    Je implementováno několik druhů AI duchů (fungující i zároveň - např. duchové se liší barvou, znakem).
2.    Lze načítat mapy ze souboru (bludiště + pozice bonusů a duchů).
3.    Konfigurovatelná obtížnost hry ze souboru (rychlost duchů, délka trvání jednotlivých módů hry, pravděpodobnost přidání nového bonusu do mapy, ...)
4.    Škálovatelná obtížnost duchů (více strategií duchů dle obtížnost, dle různého chování)

Kde lze využít polymorfismus? (doporučené)

    Rozdělení hráčů: hráč, duch (různé druhy umělé inteligence)
    Mód hry: klasický (duchové chodí dle svých strategií), zběsilý (duchové pronásledují hráče), nezranitelný (duchové jsou pomalejší, dají se zabít)
    Herní políčko: zem, stěna, bod, bonus (změna módu), třešnička (více bodů), teleport
    Uživatelské rozhraní: konzole, ncurses, SDL, OpenGL (různé varianty), ...

Další informace

    https://cs.wikipedia.org/wiki/Pac-Man
    http://programujte.com/clanek/2011010500-chovani-duchu-ve-hre-pac-man-cast-1/
    http://programujte.com/clanek/2011010900-chovani-duchu-ve-hre-pac-man-cast-2/
    
    
## Bližší specifikace zadání


( označení [1]-[4] se odkazuje na jednotlivé povinné body ze zadání)

Chování hry a její podoba bude podobná klasické hře Pac-Man( jako reference hry Pac-Man se bere popis pravidel hry dostupný skrz odkazy ve školním zadání)[1]. Hra bude umožňovat minimálně dva herní módy. Jiný než základní mód se však v podobě od klasické hry může lišit. Hra bude implementována pomocí grafického rozhraní.

Hra se bude odehrávat na předem stanovené mapě, na které se budou nacházet herní objekty. Mapu půjde načítat ze souboru[2]. Další vlastnosti bude také možné nastavit pomocí konfiguračního souboru( bude možné upravit všechny parametry ze školního zadání)[3]. Pomocí tohoto konfiguračního souboru také bude možné nastavit mód hry. Mód hry bude určovat chování duchů a tím i jejich obtížnost[4]. Oba soubory budou mít předem definovaný platný formát.

#### Popis pohyblivých herních objektů[1]:
Hráč( Pac-Man, pohyb ovládán hráčem)
Čtyři různí duchové( s chováním podle klasických pravidel, pohybuje se)
Pohybující se bonus( pokud ho hráč sebere, přičte hráči skóre, v klasické hře třešnička pohybuje se)

#### Bonusy které mohou být sebrány hráčem[1]:
Malý bonus( pokud ho hráč sebere, přičte hráči skóre, nepohybuje se)
Větší bonus( pokud ho hráč sebere, umožní hráči zabytí duchů po určitou dobu, nepohybuje se)
Pohybující se bonus...

#### Herní pole na mapě:
Zeď( objekt přes který nelze projít)
Brána( objekt přes který mohou projít jen duchové)
Prázdné políčko( běžný objekt volný k pohybu pohybujících se objektů)

Teleport na druhou stranu mapy bude také možný[1]( v případech kdy to klasická pravidla hry umožňují).


## Již provedená implementace a návrh


V průběhu implementování hry je záměr hlavně na implementace nezbytné základní kostry hry. Později dojde k rozšíření dalších funkčností do specifikovaného rozsahu. Některé prvky mohou tak například chybět( například by to mohla být extra třída pro speciální chování ducha mimo základní duchy ze hry Pac-man). Jelikož hra není zdaleka dokončena, tak se existující implementace, pokud je, nachází ve stavu prototypu. Některé části implementace jsou čistě pro umožnění kompilace dokončené části prototypu. Metody které jsou v hlavičkových souborech navíc jsou označeny komentářem TEST.


## Polymorfismus


Polymorfismus bude využit v různém chování duchů. To se týká třídy CGhost a dalších jejích potomků( CRedGhost, CTurqoiseGhost, CSienaGhost, CPurpleGhost). Jako ilustrace byl přiložen jednoduchý návrh tříd, kde byl využit polymorfismus.

#### Metody kde bude polymorfismus u duchů využit:

##### Metoda move
Deklarace metody z návrhu:\
virtual SCoordinates move(const CMap &map, const SCoordinates &playerCoords, const CGameInfo &gameInfo) = 0;

Metoda spustí pohyb ducha po mapě a navrátí novou pozici ducha po přesunu. To umožní každému duchovi chovat se přesně podle jeho vlastností. Je tak snadné implementovat různé druhy duchů.

##### Metoda getObjectInfo
Deklarace metody z návrhu:\
virtual SGameObjectInfo getObjectInfo() const = 0;

Metoda vrátí základní herní informace o herním objektu( v tomto případu duchovi). SGameObjectInfo je struktura pomocí které se v aplikaci předávájí data. Například je taková struktura předávána třídě CView, která se stará o GUI.

##### Zdůvodnění umístění polymorfismu
Hlavním smyslem více herních módů je umožnění větší rozmanitosti chování nebo druhů duchů. Polymorfismus bude využit právě proto u duchů.\
Pohybující se bonus( CMovingBonus) a hráč( CPlayer) nejsou přes podobnost do tohoto polymorfismu zahrnuti protože jejich metody se stejnou funkčností vyžadují méně argumentů. Jejich výskyt je navíc pouze vždy maximálně jeden. 

## Ovládání hry

### Klávesové vstupy
Pacman (hráč) se pohybuje klávesovými "šipkami". Při zvolení nějakého nového směru, je tento směr zapamatován a v nejbližším možném místě využit jako nový směr pohybu, lze tak naplánovat odbočení dopředu.

Při prohře lze spustit nová hra stisknutím klávesy enter.

### Spuštění hry

Způsob volání hry:\
[název programu] [cesta ke konfiguračnímu souboru] [cesta ke mapovému souboru]
Složka ze které je hra spouštěna musí obsahovat platný adresář images s texturami, jinak se hra nespustí.

##### Mapa ze souboru
Mapu je vždy potřeba načíst z textového souboru.

Ukázková mapa:

\-\-\-\-\-\-\-<br/>
|##.##|<br/>
|#...#|<br/>
|#.#G#|<br/>
|#P#X#|<br/>
|#.#G#|<br/>
|#...#|<br/>
|##@##|<br/>
\-\-\-\-\-\-\-<br/>

Každá mapa musí být ohraničena znaky (- a |) tak jak je ukázáno na ukázce. Vnitřní pole této "ohrádky" musí být vyplňeno znaky z následující množiny znaků:

 ' ' pro prázdné políčko (0 až více)<br/>
 '#' pro zeď (0 až více)<br/>
 'X' pro bránu, kterou projdou pouze duchové (0 až více)<br/>
 'P' pro hráče (právě 1)<br/>
 'G' pro ducha (alespoň 1!)<br/>
 '.' pro základní bonus (alespoň 1!)<br/>
 '@' pro bonus umožňující hráči zabíjet duchy (0 až více)<br/>
 
Minimální velikost mapy je 3x3.

V případě dodržení výše daných pravidel není problém s načtením hry. Načítání map je však tolerantní a jde vytvořit například takový soubor, kdy se mapy zčítají za sebe a je použita pouze první. Podstatné je mít za sebou jednotlivé prvky a nepoužívat znaky ohrádky mimo použití v ohrádce.

\-\-\-\-\-\-\- mimo ohradku mohou byt jakekoli ascii znaky<br/>
|##.##|<br/>
|#...#|<br/>
|#.#G#|<br/>
|#P#X#|i zde<br/>
|#.#G#|<br/>
i zde takto mohou byt znaky, nejedna se o preruseni mapy<br/>
|#...#|<br/>
|##@##|<br/>
\-\-\-\-\-\-\-

\-\-\-\-\-\-\-|##.##||#...#||#.#G#| i takto lze vytvorit mapu<br/>
|#P#X#||#.#G#|<br/>
|#...#||##@##|\-\-\-\-\-\-\-

##### Souborové vstupy
Konfigurační soubor je vždy potřeba načíst z textového souboru.

Formát konfiguračního souboru (příklad)


0 // game mode 0 for normal, 1 for hard, 2 for random
50 // ghost speed percentage, possible values =  50 - 200
15 // default neutral time length, possible values = 1 - 60
15 // default hunt on ghosts time length, possible values = 1 - 60
15 // default hunt on player time length, possible values = 1 - 60
60 //probability of moving bonus spawn, possible values = 0 - 100 (0  makes bigger probability then 100)


V souboru mohou být libovolné ascii znaky, s tou vyjímkou že na začátcích řádků musí být uvedeny jednotlivé parametry, tak jak je to uvedeno v příkladu (řádky s parametry musí jít za sebou a začínát na první řádku)





